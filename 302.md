# 確率

* 確率とは事象の起こりやすさを定量的に表現したもの
* 実際には確率の定義には様々なアプローチがある

---

## 確率の記述方法

サイコロを振って1が出る事象を事象Xとする。事象Xの確率は以下のように表現できる。

```
P(X) = 1/6
```

あるいは単純に以下のように表現することもできる。

```
P(サイコロを振って1が出る) = 1/6
```

> 確率はProbabilityの頭文字 P で表現します。また()の中には事象を記述します。

---

## 確率の定義1. 先験的確率（ラプラスの定義、古典的確率）

```
P(A) = R / N
```

* N：全事象の根元事象の数（根元事象は同様に確からしいとする）
* R：事象Aの根元事象の数

### 具体例

サイコロを振って偶数が出る事象を事象Yとする。

```
N: 6 ※1, 2, 3, 4, 5, 6 の6通り
R: 3 ※2, 4, 6 の3とおり
P(Y) = 3/6
```

> ラプラスの定義は、根元事象が"同様に確からしい"ことを前提としています。この"同様に確からしい"とは、例えば、コイン投げの裏表が出る確率がどちらも1/2になるようなケースや、サイコロの出る目はどれも1/6になるようなケースを指します。

---

## 確率の定義2. 経験的確率（頻度による確率の定義）

* イカサマのサイコロがある場合、1の目の出る確率は実際に振ってみないとわからない。
* このようなケースにおいては繰り返し何度もサイコロを振ることで、1の目の出る確率を求めることができる。
* たとえば100回サイコロを振って、1の目が50回出た場合、1の目の出る確率は 50/100 と推測できる

> "同様に確からしい" という前提を満たさない場合は頻度による確率の定義を考えます。

### 具体例

* 以下のようなイカサマのサイコロを準備した場合

|1|2|3|4|5|6|
|:--|:--|:--|:--|:--|:--|
|0.5|0.1|0.1|0.1|0.1|0.1|

* 実際には上記の確率分布を知らなくても、試行を何度も繰り返すことで相対頻度（1が出た回数/試行回数）から確率を求めることができる

#### Rのサンプルコード

```r
dice_prob <- c(0.5, 0.1, 0.1, 0.1, 0.1, 0.1)
for (i in 1:3) {
  dice <- sample(1:6, size = 100, prob = dice_prob, replace = T)
  print(table(dice))
}
```

#### 実行結果

```r
> dice_prob <- c(0.5, 0.1, 0.1, 0.1, 0.1, 0.1)
> for (i in 1:3) {
+   dice <- sample(1:6, size = 100, prob = dice_prob, replace = T)
+   print(table(dice))
+ }
dice
 1  2  3  4  5  6 
60  8 15  3  7  7 
dice
 1  2  3  4  5  6 
51  9 14 10  7  9 
dice
 1  2  3  4  5  6 
55 11 11  6 11  6 
```

> 実行結果は誤差を含みます。試行回数を増やせば1の出る確率は理論値の0.5に近づきます。

---

## 確率の定義3. 主観的確率

* 先験的確率や経験的確率は誰が計算しても同じ結果になる（客観的確率）
* 上記のアプローチが取れない場合においては、分析者が対象に対して主観的に確率を与えて分析を行う手法がある
* このような主観的確率は、ベイズの定理という手法を用いるためベイズ統計学とも呼ばれる

> ベイズの定理については後述します。

---

## 確率の定義4. 確率の公理

* すべての事象Aに対して 0 <= P(A) <= 1 
* P(Ω) = 1
* 排反な事象A1,A2,A3...に対して P(A1 ∪ A2 ∪ A3...) = P(A1) + P(A2) + P(A3) ...

> 確率の公理はコルモゴロフの公理とも呼ばれます。先験的確率・経験的確率・主観的確率のいずれの手法を用いるとしても確率の公理に従います。

---