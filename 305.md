# 条件付き確率と乗法定理

* 複数の異なる事象について確率を求めることができる
* P(A∩B)に関する乗法定理がある
* 乗法定理を扱う前に条件付き確率を理解する必要がある

---

## 条件付き確率

```
事象Bが起きたという条件のもとに事象Aが起こる確率を条件付き確率という
P(A|B) = P(A∩B) / P(B)
```

> 条件付き確率は、| を使って表現します。例えば事象Xが起きたという条件のもとに事象Yが起こる確率は `P(Y|X)` と表現します。XとYの書き方の順序に注意してください。

### 具体例 - 条件付き確率ではないケース

* 2つのサイコロを振った合計が10以上（事象A）となる確率

```
2つのサイコロの出た目の標本空間（36個の標本点）
(1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6)
(2, 1) (2, 2) (2, 3) (2, 4) (2, 5) (2, 6)
(3, 1) (3, 2) (3, 3) (3, 4) (3, 5) (3, 6)
(4, 1) (4, 2) (4, 3) (4, 4) (4, 5) (4, 6)
(5, 1) (5, 2) (5, 3) (5, 4) (5, 5) (5, 6)
(6, 1) (6, 2) (6, 3) (6, 4) (6, 5) (6, 6)
```

* 2つのサイコロを振った合計が10以上（事象A）

```



                                    (4, 6)
                             (5, 5) (5, 6)
                      (6, 4) (6, 5) (6, 6)
```

* 事象Aの確率

```
P(A) = 6/36 = 1/6
```

> 以下の条件付き確率によって、確率がどのように変わるかを確認しましょう。

### 条件付き確率の例 - 1つ目のサイコロが5である（事象B）という条件が与えられた場合

* 2つのサイコロを振った合計が10以上（事象A）
* このとき、1つ目のサイコロが5である（事象B）
* 事象Bを条件とする事象Aの条件付き確率を考える

```
2つのサイコロの出た目の標本空間（36個の標本点）
(1, 1) (1, 2) (1, 3) (1, 4) (1, 5) (1, 6)
(2, 1) (2, 2) (2, 3) (2, 4) (2, 5) (2, 6)
(3, 1) (3, 2) (3, 3) (3, 4) (3, 5) (3, 6)
(4, 1) (4, 2) (4, 3) (4, 4) (4, 5) (4, 6)
(5, 1) (5, 2) (5, 3) (5, 4) (5, 5) (5, 6)
(6, 1) (6, 2) (6, 3) (6, 4) (6, 5) (6, 6)
```

* 2つのサイコロを振った合計が10以上（事象A）

```



                                    (4, 6)
                             (5, 5) (5, 6)
                      (6, 4) (6, 5) (6, 6)
```

* 1つ目のサイコロが5である（事象B）

```




(5, 1) (5, 2) (5, 3) (5, 4) (5, 5) (5, 6)

```

* 事象Aと事象Bの積事象（A∩B）


```




                            (5, 5) (5, 6)

```

* 1つ目のサイコロが5である（事象B）の確率：P(B)
* 事象A、Bの積事象の確率（同時確率）：P(A∩B)
* 事象Bを条件とする事象Aの条件付き確率：P(A|B)


```
P(B) = 6/36
P(A∩B) = 2/36 
P(A|B) = P(A∩B) / P(B) = (2/36) / (6/36) = 2/6 = 1/3
```

> 事象Bという条件が与えられたことで、事象Aの確率が1/3に変化したところを確認しておいてください。

---

## 乗法定理

* 条件付き確率は以下のように変形できる（乗法定理） 

```
P(A∩B) = P(B)P(A|B)
```

> `P(A∩B)` は同時確率とも呼ばれます。乗法定理は事象Bの起こる確率 `P(B)` と事象Bを条件とする事象Aの条件付き確率 `P(A|B)` の積で表現できます。

### 具体例

* 2つのサイコロを振った合計が10以上(事象A)の確率：P(A)
* 1つ目のサイコロが5である（事象B）の確率：P(B)
* 事象Bを条件とする事象Aの条件付き確率：P(A|B)

```
P(A) = 6/36
P(B) = 6/36
P(A|B) = 2/6 
P(A∩B) = P(B)P(A|B) = 6/36 * 2/6 = 2/36
```

---

## 独立(independent)

* 試行の結果が後の試行に影響しないことを独立（独立な試行）であるという

```
事象Bの試行と事象Aの試行が独立であるとき条件式確率は以下のようになる
P(A|B) = P(A)
```

> 事象Bの試行と事象Aの試行が独立であるとき、P(A|B)が不要となります。

* 事象Aの試行と事象Bの試行が独立であるとき乗法定理は以下のようになる

```
P(A∩B) = P(B)P(A)
```

> 事象Bの試行と事象Aの試行が独立であるとき、乗法定理はシンプルに確率の積で表現されます。


---

## エクササイズ
